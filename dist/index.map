{"version":3,"sources":["../rangeSlider/rangeSlider.js","../rangeSlider/index.js","audioPlayer.js","index.js"],"names":["defaultOptions","className","total","value","draggerSize","barHeight","onChange","min","max","RangeSlider","parent","options","Object","assign","document","body","isMoving","container","dragger","bar","_handleMouseDown","bind","_handleMouseUp","_handleMouseMove","_handleResize","_init","_render","position","_calculatePosition","_updateUI","createElement","style","height","paddingLeft","paddingRight","width","top","positionMax","Math","round","_getPositionMax","_createContainer","_createBar","_createDragger","appendChild","_bindEvent","event","elementLeft","getBoundingClientRect","left","documentElement","scrollLeft","abs","mousePos","pageX","offsetWidth","_calculateValue","setValue","_move","addEventListener","window","removeEventListener","slider","_createSlider","innerHTML","_removeEvent","autoPlay","duration","players","initialSingletonPlay","console","count","e","warn","i","len","length","target","pause","AudioPlayer","timeHoler","toggleBtn","isPlaying","player","sliderId","_getSliderId","togglePlay","_createUI","_initialPlayer","_initialEvents","onclick","url","Error","Audio","onloadedmetadata","_initializeSlider","_updateTimeDisplay","currentTime","ontimeupdate","time","currentTarget","onended","_playStatusChange","onpause","onerror","preload","push","undefined","play","querySelector","randLetter","String","fromCharCode","floor","random","Date","now","toggle","progress","timer","innerText","append","_formatTime2HHMMSS","seconds","date","setMilliseconds","result","toISOString","substr","splits","split","slice","join","_removeEvents"],"mappings":"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","file":"index.map","sourceRoot":"../src/audioPlayer","sourcesContent":["// reference: https://stackoverflow.com/a/33006528/1553656\n\nimport \"./rangeSlider.css\";\n\nconst defaultOptions = {\n  className: \"\",\n\n  total: 100,\n  value: 0,\n  draggerSize: 12,\n  barHeight: 2,\n  onChange: null,\n\n  min: 0,\n  max: 100\n};\n\nexport default class RangeSlider {\n  constructor(parent, options) {\n    this.options = Object.assign({}, defaultOptions, options);\n    this.parent = parent || document.body;\n    this.isMoving = false;\n    this.container = null;\n    this.dragger = null;\n    this.bar = null;\n\n    this._handleMouseDown = this._handleMouseDown.bind(this);\n    this._handleMouseUp = this._handleMouseUp.bind(this);\n    this._handleMouseMove = this._handleMouseMove.bind(this);\n    this._handleResize = this._handleResize.bind(this);\n\n    this._init();\n  }\n\n  _init() {\n    this._render();\n    const position = this._calculatePosition(this.options.value);\n    this._updateUI(position);\n  }\n\n  _createContainer() {\n    const container = document.createElement(\"div\");\n    container.className = `range-slider ${this.options.className}`;\n    container.style.height = `${this.options.barHeight}px`;\n    this.container = container;\n    return container;\n  }\n\n  _createBar() {\n    const bar = document.createElement(\"span\");\n    bar.style.height = `${this.options.barHeight}px`;\n    bar.style.paddingLeft = `${this.options.draggerSize / 2}px`;\n    bar.style.paddingRight = `${this.options.draggerSize / 2}px`;\n    bar.className = \"progress-bar\";\n    this.bar = bar;\n    return bar;\n  }\n\n  _createDragger() {\n    const dragger = document.createElement(\"span\");\n    dragger.style.width = `${this.options.draggerSize}px`;\n    dragger.style.height = `${this.options.draggerSize}px`;\n    dragger.style.top = `-${(this.options.draggerSize -\n      this.options.barHeight) /\n      2}px`;\n    dragger.className = \"progress-dragger\";\n    this.dragger = dragger;\n    return dragger;\n  }\n\n  _calculateValue(position, positionMax) {\n    const value =\n      (position * (this.options.max - this.options.min)) / positionMax +\n      this.options.min;\n    return Math.round(value);\n  }\n\n  _calculatePosition(value) {\n    const positionMax = this._getPositionMax();\n    return (\n      ((value - this.options.min) * positionMax) /\n      (this.options.max - this.options.min)\n    );\n  }\n\n  _createSlider() {\n    const container = this._createContainer();\n    const bar = this._createBar();\n    const dragger = this._createDragger();\n    bar.appendChild(dragger);\n    container.appendChild(bar);\n\n    this._bindEvent(container);\n\n    return container;\n  }\n\n  _move(event) {\n    if (!this.isMoving) return;\n    let min = 0,\n      max = this._getPositionMax();\n\n    // Instead of using `offsetLeft`, we need to using `getBoundingClientRect().left. Because the offsetLeft is relative to none static parent.\n    let elementLeft = this.container.getBoundingClientRect().left;\n\n    // fix for scroll\n    elementLeft += document.documentElement.scrollLeft;\n\n    if (elementLeft < 0) elementLeft = Math.abs(elementLeft) / 2;\n    let mousePos = event.pageX - elementLeft - this.dragger.offsetWidth / 2,\n      position = mousePos > max ? max : mousePos < min ? min : mousePos;\n\n    const value = this._calculateValue(position, max);\n    this.setValue(value);\n    if (this.options.onChange) {\n      this.options.onChange(value);\n    }\n  }\n\n  _getPositionMax() {\n    return this.container.offsetWidth - this.dragger.offsetWidth;\n  }\n\n  _updateUI(position) {\n    const positionMax = this._getPositionMax();\n    this.dragger.style.left = `${position}px`;\n    let width = (position / positionMax) * 100;\n    this.bar.style.width = `${width}%`;\n  }\n\n  _handleMouseDown(event) {\n    this.isMoving = true;\n    this._move(event);\n  }\n\n  _handleMouseUp(event) {\n    this.isMoving = false;\n  }\n\n  _handleMouseMove(event) {\n    this._move(event);\n  }\n\n  _handleResize(event) {\n    this._init();\n  }\n\n  _bindEvent(container) {\n    container.addEventListener(\"mousedown\", this._handleMouseDown);\n    document.addEventListener(\"mouseup\", this._handleMouseUp);\n    document.addEventListener(\"mousemove\", this._handleMouseMove);\n    window.addEventListener(\"resize\", this._handleResize, true);\n  }\n\n  _removeEvent() {\n    if (!this.container) return;\n    this.container.removeEventListener(\"mousedown\", this._handleMouseDown);\n    document.removeEventListener(\"mouseup\", this._handleMouseUp);\n    document.removeEventListener(\"mousemove\", this._handleMouseMove);\n  }\n\n  _render() {\n    const slider = this._createSlider();\n    this.parent.innerHTML = \"\";\n    this.parent.appendChild(slider);\n  }\n\n  destroy() {\n    this._removeEvent();\n  }\n\n  getValue() {\n    return this.options.value;\n  }\n\n  setValue(value) {\n    this.options.value = value;\n    const position = this._calculatePosition(value);\n    this._updateUI(position);\n  }\n}\n","export {default} from './rangeSlider'","/*\n * @author: wayou \n * @date: 2018-11-08 10:25:29 \n * @description: audio player with ui control\n * media events references: https://developer.mozilla.org/en-US/docs/Web/Guide/Events/Media_events\n * \n */\n\nimport \"./audioPlayer.css\";\nimport RangeSlider from \"../rangeSlider\";\n\nconst defaultOptions = {\n  parent: document.body,\n  autoPlay: false,\n  duration: 0\n};\n\nconst players = [];\n\nfunction initialSingletonPlay() {\n  console.count(\"listenall\");\n  // guarantee that here's only one player is playing\n  // const players = document.querySelectorAll(\"audio\");\n  document.addEventListener(\n    \"play\",\n    e => {\n      console.warn(\"onplay\");\n      for (var i = 0, len = players.length; i < len; i++) {\n        if (players[i] != e.target) {\n          console.warn(\"paused\");\n          players[i].pause();\n        }\n      }\n    },\n    true\n  );\n}\n\ninitialSingletonPlay();\n\nexport default class AudioPlayer {\n  constructor(options) {\n    this.options = Object.assign({}, defaultOptions, options);\n\n    this.container = null;\n    this.timeHoler = null;\n    this.toggleBtn = null;\n    this.slider = null;\n    this.isPlaying = false;\n    this.player = null;\n    this.sliderId = this._getSliderId();\n\n    this.togglePlay = this.togglePlay.bind(this);\n\n    this._init();\n  }\n\n  _init() {\n    this.container = this._createUI();\n    this.options.parent.innerHTML = \"\";\n    this.options.parent.appendChild(this.container);\n\n    this._initialPlayer();\n    this._initialEvents();\n  }\n\n  _initialEvents() {\n    this.toggleBtn.onclick = this.togglePlay;\n  }\n\n  _initialPlayer() {\n    if (!this.options.url) {\n      throw new Error(`missing audio url`);\n    }\n\n    this.player = new Audio(this.options.url);\n    this.player.onloadedmetadata = () => {\n      this._initializeSlider(this.player.duration);\n      this._updateTimeDisplay(this.player.currentTime, this.player.duration);\n    };\n\n    this.player.ontimeupdate = event => {\n      const time = event.currentTarget.currentTime;\n      this.slider.setValue(time);\n      this._updateTimeDisplay(time, this.player.duration);\n    };\n\n    this.player.onended = () => {\n      this._playStatusChange(false);\n    };\n\n    this.player.onpause = () => {\n      this._playStatusChange(false);\n    };\n\n    this.player.onerror = () => {\n      this._playStatusChange(false);\n    };\n\n    this.player.preload = \"metadata\";\n\n    // we need to append the audio to DOM or the document.addEventListener won't fire\n    this.container.appendChild(this.player);\n    players.push(this.player);\n  }\n\n  _removeEvents() {\n    this.toggleBtn.onclick = undefined;\n  }\n\n  togglePlay() {\n    const isPlaying = !this.isPlaying;\n    if (isPlaying) {\n      this.play();\n    } else {\n      this.pause();\n    }\n  }\n\n  play() {\n    this.player.play();\n    this._playStatusChange(true);\n  }\n\n  pause() {\n    this.player.pause();\n    this._playStatusChange(false);\n  }\n\n  _playStatusChange(isPlaying) {\n    this.isPlaying = isPlaying;\n    this.toggleBtn.className = `icon icon-${this.isPlaying ? \"pause\" : \"play\"}`;\n  }\n\n  _initializeSlider(duration) {\n    this.slider = new RangeSlider(document.querySelector(`#${this.sliderId}`), {\n      max: duration,\n      onChange: value => {\n        this.player.currentTime = value;\n      }\n    });\n  }\n\n  /**\n   * guid generation taken from https://stackoverflow.com/questions/6860853/generate-random-string-for-div-id/6860916#6860916\n   */\n  _getSliderId() {\n    var randLetter = String.fromCharCode(65 + Math.floor(Math.random() * 26));\n    return randLetter + Date.now();\n  }\n\n  _createUI() {\n    const container = document.createElement(\"div\");\n    container.className = \"audio-player\";\n\n    const toggle = document.createElement(\"div\");\n    toggle.className = \"player-section player-toggle\";\n    this.toggleBtn = document.createElement(\"span\");\n    this.toggleBtn.className = `icon icon-play`;\n    toggle.appendChild(this.toggleBtn);\n    container.appendChild(toggle);\n\n    const progress = document.createElement(\"div\");\n    progress.className = \"player-section player-progress\";\n    progress.innerHTML = `<div class=\"player-slider\" id=\"${\n      this.sliderId\n    }\"></div>`;\n    container.appendChild(progress);\n\n    const timer = document.createElement(\"div\");\n    timer.className = \"player-section player-time\";\n    this.timeHoler = document.createElement(\"div\");\n    this.timeHoler.className = \"time\";\n    this.timeHoler.innerText = \"00:00\";\n    timer.append(this.timeHoler);\n\n    container.appendChild(timer);\n    return container;\n  }\n\n  _updateTimeDisplay(time, duration) {\n    time = this._formatTime2HHMMSS(time);\n    duration = this._formatTime2HHMMSS(duration);\n    this.timeHoler.innerText = `${time}/${duration}`;\n  }\n\n  _formatTime2HHMMSS(seconds) {\n    const date = new Date(null);\n    date.setMilliseconds(seconds * 1000);\n    let result = date.toISOString().substr(11, 8);\n\n    let splits = result.split(\":\");\n    if (splits.length > 2 && splits[0] === \"00\") {\n      result = splits.slice(1).join(\":\");\n    }\n    return result;\n  }\n\n  destroy() {\n    this._removeEvents();\n  }\n}\n","export { default } from \"./audioPlayer\";\n"]}